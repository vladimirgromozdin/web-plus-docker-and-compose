{"ast":null,"code":"import _toConsumableArray from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{GoodCard}from\"../good-card\";import{Modal,Button}from\"../ui\";import cancelIcon from\"../../images/icons/cancel.svg\";import trashIcon from\"../../images/icons/trash-red.svg\";import{getOwnWishes,removeWish}from\"../../utils/api\";import styles from\"./wishlist-page.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var WishlistPage=function WishlistPage(_ref){var _ref$extraClass=_ref.extraClass,extraClass=_ref$extraClass===void 0?\"\":_ref$extraClass;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),currentCardsId=_useState2[0],setCurrentCardsId=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setOwnWishes=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isPopupOpen=_useState6[0],setIsPopupOpen=_useState6[1];useEffect(function(){if(sessionStorage.getItem(\"auth_token\")){getOwnWishes().then(function(res){setOwnWishes(res);});}},[]);var handlePopupOpen=function handlePopupOpen(){setIsPopupOpen(true);};var handlePopupClose=function handlePopupClose(){setIsPopupOpen(false);};var onCardClick=function onCardClick(e){var card=e.target.tagName===\"ARTICLE\"?e.target:e.target.closest(\"article\");if(currentCardsId.indexOf(+card.id)!==-1){var arr=_toConsumableArray(currentCardsId);arr.splice(currentCardsId.indexOf(+card.id),1);setCurrentCardsId(arr);}else{setCurrentCardsId([].concat(_toConsumableArray(currentCardsId),[+card.id]));}};var handleRemoveSelection=function handleRemoveSelection(){isPopupOpen&&setIsPopupOpen(false);setCurrentCardsId([]);};var handleRemoveCards=function handleRemoveCards(){Promise.all(currentCardsId.map(function(id){return removeWish(id).catch();})).then(function(){getOwnWishes().then(function(res){setCurrentCardsId([]);setOwnWishes(res);handlePopupClose();});});};return/*#__PURE__*/_jsxs(\"section\",{className:\"\".concat(styles.content,\" \").concat(extraClass),children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text text_type_h1 text_color_primary \".concat(styles.title),children:\"\\u041C\\u043E\\u0439 \\u0432\\u0438\\u0448\\u043B\\u0438\\u0441\\u0442\"}),currentCardsId.length?/*#__PURE__*/_jsxs(\"div\",{className:styles.menu,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_button\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0442\\u043E, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C | \".concat(currentCardsId.length,\" \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043E\")}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btn_box,children:[/*#__PURE__*/_jsxs(\"button\",{className:styles.btn,type:\"button\",onClick:handleRemoveSelection,children:[/*#__PURE__*/_jsx(\"img\",{src:cancelIcon,alt:\"\\u041A\\u043D\\u043E\\u043F\\u043A\\u0430 \\u0441\\u043D\\u044F\\u0442\\u0438\\u044F \\u0432\\u044B\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u044F.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_button ml-4\",children:\"\\u0421\\u043D\\u044F\\u0442\\u044C \\u0432\\u044B\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u0435\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:styles.btn,type:\"button\",onClick:handlePopupOpen,children:[/*#__PURE__*/_jsx(\"img\",{src:trashIcon,alt:\"\\u041A\\u043D\\u043E\\u043F\\u043A\\u0430 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u044F \\u043A\\u0430\\u0440\\u0442\\u043E\\u0447\\u043A\\u0438.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_button text_color_red-bg ml-4\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435\"})]}),isPopupOpen&&/*#__PURE__*/_jsx(Modal,{onClose:handlePopupClose,extraClass:styles.modal,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.popup,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_main mb-10\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0438?\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.popup_btn_box,children:[/*#__PURE__*/_jsx(Button,{type:\"button\",extraClass:styles.popup_btn,kind:\"support\",text:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\",onClick:handleRemoveSelection}),/*#__PURE__*/_jsx(Button,{type:\"button\",extraClass:styles.popup_btn,kind:\"secondary\",onClick:handleRemoveCards,text:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]})})]})]}):\"\",/*#__PURE__*/_jsx(\"div\",{className:styles.cards_box,children:data.map(function(_ref2){var id=_ref2.id,price=_ref2.price,image=_ref2.image,name=_ref2.name,raised=_ref2.raised;var withBorder=false;if(currentCardsId.indexOf(id)!==-1){withBorder=true;}return/*#__PURE__*/_jsx(GoodCard,{id:id,onClick:onCardClick,price:price,img:image,name:name,current:raised,extraClass:withBorder?styles.border:\"\"},id);})})]});};","map":{"version":3,"sources":["/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/src/components/wishlist-page/wishlist-page.jsx"],"names":["useState","useEffect","GoodCard","Modal","Button","cancelIcon","trashIcon","getOwnWishes","removeWish","styles","WishlistPage","extraClass","currentCardsId","setCurrentCardsId","data","setOwnWishes","isPopupOpen","setIsPopupOpen","sessionStorage","getItem","then","res","handlePopupOpen","handlePopupClose","onCardClick","e","card","target","tagName","closest","indexOf","id","arr","splice","handleRemoveSelection","handleRemoveCards","Promise","all","map","catch","content","title","length","menu","btn_box","btn","modal","popup","popup_btn_box","popup_btn","cards_box","price","image","name","raised","withBorder","border"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\n\nimport { GoodCard } from \"../good-card\";\n\nimport { Modal, Button } from \"../ui\";\n\nimport cancelIcon from \"../../images/icons/cancel.svg\";\nimport trashIcon from \"../../images/icons/trash-red.svg\";\n\nimport { getOwnWishes, removeWish } from \"../../utils/api\";\n\nimport styles from \"./wishlist-page.module.css\";\n\nexport const WishlistPage = ({ extraClass = \"\" }) => {\n  const [currentCardsId, setCurrentCardsId] = useState([]);\n  const [data, setOwnWishes] = useState([]);\n\n  const [isPopupOpen, setIsPopupOpen] = useState(false);\n\n  useEffect(() => {\n    if (sessionStorage.getItem(\"auth_token\")) {\n      getOwnWishes().then((res) => {\n        setOwnWishes(res);\n      });\n    }\n  }, []);\n\n  const handlePopupOpen = () => {\n    setIsPopupOpen(true);\n  };\n\n  const handlePopupClose = () => {\n    setIsPopupOpen(false);\n  };\n\n  const onCardClick = (e) => {\n    const card =\n      e.target.tagName === \"ARTICLE\" ? e.target : e.target.closest(\"article\");\n    if (currentCardsId.indexOf(+card.id) !== -1) {\n      const arr = [...currentCardsId];\n      arr.splice(currentCardsId.indexOf(+card.id), 1);\n      setCurrentCardsId(arr);\n    } else {\n      setCurrentCardsId([...currentCardsId, +card.id]);\n    }\n  };\n\n  const handleRemoveSelection = () => {\n    isPopupOpen && setIsPopupOpen(false);\n    setCurrentCardsId([]);\n  };\n\n  const handleRemoveCards = () => {\n    Promise.all(currentCardsId.map((id) => removeWish(id).catch())).then(() => {\n      getOwnWishes().then((res) => {\n        setCurrentCardsId([]);\n        setOwnWishes(res);\n        handlePopupClose();\n      });\n    });\n  };\n\n  return (\n    <section className={`${styles.content} ${extraClass}`}>\n      <h1 className={`text text_type_h1 text_color_primary ${styles.title}`}>\n        Мой вишлист\n      </h1>\n      {currentCardsId.length ? (\n        <div className={styles.menu}>\n          <p className=\"text text_type_button\">{`Выберите то, что хотите удалить | ${currentCardsId.length} выбрано`}</p>\n          <div className={styles.btn_box}>\n            <button\n              className={styles.btn}\n              type=\"button\"\n              onClick={handleRemoveSelection}\n            >\n              <img src={cancelIcon} alt=\"Кнопка снятия выделения.\" />\n              <p className=\"text text_type_button ml-4\">Снять выделение</p>\n            </button>\n            <button\n              className={styles.btn}\n              type=\"button\"\n              onClick={handlePopupOpen}\n            >\n              <img src={trashIcon} alt=\"Кнопка удаления карточки.\" />\n              <p className=\"text text_type_button text_color_red-bg ml-4\">\n                Удалить выбранное\n              </p>\n            </button>\n            {isPopupOpen && (\n              <Modal onClose={handlePopupClose} extraClass={styles.modal}>\n                <div className={styles.popup}>\n                  <p className=\"text text_type_main mb-10\">\n                    Удалить выбранные подарки?\n                  </p>\n                  <div className={styles.popup_btn_box}>\n                    <Button\n                      type=\"button\"\n                      extraClass={styles.popup_btn}\n                      kind=\"support\"\n                      text=\"Отмена\"\n                      onClick={handleRemoveSelection}\n                    />\n                    <Button\n                      type=\"button\"\n                      extraClass={styles.popup_btn}\n                      kind=\"secondary\"\n                      onClick={handleRemoveCards}\n                      text=\"Удалить\"\n                    />\n                  </div>\n                </div>\n              </Modal>\n            )}\n          </div>\n        </div>\n      ) : (\n        \"\"\n      )}\n      <div className={styles.cards_box}>\n        {data.map(({ id, price, image, name, raised }) => {\n          let withBorder = false;\n          if (currentCardsId.indexOf(id) !== -1) {\n            withBorder = true;\n          }\n          return (\n            <GoodCard\n              key={id}\n              id={id}\n              onClick={onCardClick}\n              price={price}\n              img={image}\n              name={name}\n              current={raised}\n              extraClass={withBorder ? styles.border : \"\"}\n            />\n          );\n        })}\n      </div>\n    </section>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}