{"ast":null,"code":"var _jsxFileName = \"/Users/vladimirgromozdin/Documents/dev/kupipodariday-frontend/src/components/gift-page/gift-page.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { NavLink, useParams, useHistory } from \"react-router-dom\";\nimport { Button, ButtonReturn, LoadingBox, Modal, Input } from \"../ui\";\nimport { UserSupportedCard } from \"../user-supported-card\";\nimport { priceArr } from \"../../utils/constants\";\nimport { addOffer, getCard, copyWish, getOwnWishes } from \"../../utils/api\";\nimport styles from \"./gift-page.module.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const GiftPage = _ref => {\n  _s();\n\n  var _wishData$owner, _wishData$owner2, _wishData$offers, _wishData$offers2;\n\n  let {\n    extraClass = \"\"\n  } = _ref;\n  const history = useHistory();\n  const {\n    id\n  } = useParams();\n  const [isPopupOpen, setIsPopupOpen] = useState(false);\n  const [isAddToWishDisabled, setIsAddToWishDisabled] = useState(false);\n  const [currentSupportedBtn, setCurrentSupportedBtn] = useState(100);\n  const [anotherSum, setAnotherSum] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [wishData, setWishData] = useState({});\n  useEffect(() => {\n    if (sessionStorage.getItem(\"auth_token\")) {\n      Promise.all([getCard(id), getOwnWishes()]).then(_ref2 => {\n        let [card, wishlist] = _ref2;\n        setWishData(card);\n        const goodInMyWish = wishlist.find(item => item.id === card.id);\n\n        if (goodInMyWish) {\n          setIsAddToWishDisabled(true);\n        }\n      });\n    }\n  }, [id]);\n  const isRaised = wishData.raised === wishData.price;\n\n  const handlePopupOpen = () => {\n    setIsPopupOpen(true);\n  };\n\n  const handleSupportClick = () => {\n    errorMessage && setErrorMessage(\"\");\n    const amount = +anotherSum || currentSupportedBtn;\n    addOffer({\n      itemId: wishData.id,\n      amount,\n      hidden: false\n    }).then(() => {\n      handlePopupClose();\n      getCard(id).then(res => {\n        setWishData(res);\n      });\n    }).catch(err => {\n      setErrorMessage(err.message);\n    });\n  };\n\n  const handleGoToShop = () => {\n    window.open(wishData.link, \"_blank\");\n  };\n\n  const handleCopyClick = () => {\n    copyWish(wishData.id).then(() => history.push(\"/wishlist\"));\n  };\n\n  const handlePopupClose = () => {\n    setIsPopupOpen(false);\n  };\n\n  const handleSupportedBtnsClick = e => {\n    const id = +e.target.closest(\"button\").getAttribute(\"id\");\n    setCurrentSupportedBtn(id);\n    setAnotherSum(\"\");\n  };\n\n  const handleChangeInput = e => {\n    const sum = e.target.value;\n    setAnotherSum(sum);\n    setCurrentSupportedBtn(+sum);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: `${styles.content} ${extraClass}`,\n    children: [/*#__PURE__*/_jsxDEV(ButtonReturn, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text text_type_h1 mb-16\",\n      children: wishData.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.data_box,\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: styles.img,\n        src: wishData.image,\n        alt: \"\\u0424\\u043E\\u0442\\u043E \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0430.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.gift_data,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text text_type_h1 mb-16\",\n          children: `${wishData.price} руб.`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text text_type_main\",\n          style: {\n            maxWidth: \"75%\"\n          },\n          children: [`Добавлено ${new Date(wishData.createdAt).toLocaleDateString()} пользователем `, /*#__PURE__*/_jsxDEV(NavLink, {\n            to: `/users/${wishData === null || wishData === void 0 ? void 0 : (_wishData$owner = wishData.owner) === null || _wishData$owner === void 0 ? void 0 : _wishData$owner.username}`,\n            className: `text text_type_main text_color_primary ${styles.link}`,\n            children: `${wishData === null || wishData === void 0 ? void 0 : (_wishData$owner2 = wishData.owner) === null || _wishData$owner2 === void 0 ? void 0 : _wishData$owner2.username} ${\"\\u{2197}\"}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text text_type_main\",\n          style: {\n            maxWidth: \"75%\"\n          },\n          children: `Описание: ${wishData.description}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LoadingBox, {\n          current: wishData.raised,\n          total: wishData.price,\n          extraClass: styles.load\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.btns_box,\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            type: \"support\",\n            kind: \"thirdly\",\n            text: \"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0432 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\",\n            extraClass: styles.btn,\n            onClick: handleGoToShop\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"button\",\n            kind: \"secondary\",\n            text: \"\\u041F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0430\\u0442\\u044C\",\n            extraClass: styles.btn,\n            onClick: handlePopupOpen,\n            disabled: isRaised\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"button\",\n            kind: \"support\",\n            text: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0432 \\u0432\\u0438\\u0448\\u043B\\u0438\\u0441\\u0442\",\n            extraClass: styles.btn,\n            onClick: handleCopyClick,\n            disabled: isAddToWishDisabled\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.supported_box,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.subtitle_box,\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text text_ty-e_h2\",\n          children: \"\\u0421\\u043F\\u0438\\u0441\\u043E\\u043A \\u043F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0430\\u0432\\u0448\\u0438\\u0445\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), wishData !== null && wishData !== void 0 && (_wishData$offers = wishData.offers) !== null && _wishData$offers !== void 0 && _wishData$offers.length ? wishData === null || wishData === void 0 ? void 0 : (_wishData$offers2 = wishData.offers) === null || _wishData$offers2 === void 0 ? void 0 : _wishData$offers2.map(_ref3 => {\n        let {\n          name,\n          amount,\n          createdAt\n        } = _ref3;\n        return /*#__PURE__*/_jsxDEV(UserSupportedCard, {\n          name: name,\n          amount: amount,\n          date: createdAt\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this);\n      }) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041F\\u043E\\u043A\\u0430 \\u043D\\u0438\\u043A\\u043E\\u0433\\u043E \\u043D\\u0435\\u0442\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this), isPopupOpen && /*#__PURE__*/_jsxDEV(Modal, {\n      onClose: handlePopupClose,\n      extraClass: styles.modal,\n      isCloseBtn: true,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.popup,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text text_type_h2 mb-20\",\n          children: \"\\u041F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0438\\u0442\\u0435 \\u043B\\u044E\\u0431\\u043E\\u0439 \\u0441\\u0443\\u043C\\u043C\\u043E\\u0439\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `mb-20 ${styles.gift_btns_box}`,\n          children: [priceArr.map((item, index) => {\n            return /*#__PURE__*/_jsxDEV(Button, {\n              id: item,\n              type: \"button\",\n              extraClass: styles.price_btn,\n              text: `${item} руб`,\n              kind: currentSupportedBtn === item || currentSupportedBtn === anotherSum ? \"primary\" : \"support\",\n              onClick: handleSupportedBtnsClick\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 19\n            }, this);\n          }), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"number\",\n            extraInputClass: styles.price_input,\n            placeholder: \"\\u0421\\u0443\\u043C\\u043C\\u0430\",\n            value: anotherSum,\n            onChange: handleChangeInput\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"button\",\n          kind: \"secondary\",\n          text: \"\\u041F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u0430\\u0442\\u044C\",\n          onClick: handleSupportClick,\n          extraClass: styles.supported_btn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: styles.error,\n          children: errorMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n\n_s(GiftPage, \"zCzIlfA1VcFRqx+RJcnXNAYBTOk=\", false, function () {\n  return [useHistory, useParams];\n});\n\n_c = GiftPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"GiftPage\");","map":{"version":3,"sources":["/Users/vladimirgromozdin/Documents/dev/kupipodariday-frontend/src/components/gift-page/gift-page.jsx"],"names":["useState","useEffect","NavLink","useParams","useHistory","Button","ButtonReturn","LoadingBox","Modal","Input","UserSupportedCard","priceArr","addOffer","getCard","copyWish","getOwnWishes","styles","GiftPage","extraClass","history","id","isPopupOpen","setIsPopupOpen","isAddToWishDisabled","setIsAddToWishDisabled","currentSupportedBtn","setCurrentSupportedBtn","anotherSum","setAnotherSum","errorMessage","setErrorMessage","wishData","setWishData","sessionStorage","getItem","Promise","all","then","card","wishlist","goodInMyWish","find","item","isRaised","raised","price","handlePopupOpen","handleSupportClick","amount","itemId","hidden","handlePopupClose","res","catch","err","message","handleGoToShop","window","open","link","handleCopyClick","push","handleSupportedBtnsClick","e","target","closest","getAttribute","handleChangeInput","sum","value","content","name","data_box","img","image","gift_data","maxWidth","Date","createdAt","toLocaleDateString","owner","username","description","load","btns_box","btn","supported_box","subtitle_box","offers","length","map","modal","popup","gift_btns_box","index","price_btn","price_input","supported_btn","error"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { NavLink, useParams, useHistory } from \"react-router-dom\";\n\nimport { Button, ButtonReturn, LoadingBox, Modal, Input } from \"../ui\";\nimport { UserSupportedCard } from \"../user-supported-card\";\n\nimport { priceArr } from \"../../utils/constants\";\n\nimport { addOffer, getCard, copyWish, getOwnWishes } from \"../../utils/api\";\n\nimport styles from \"./gift-page.module.css\";\n\nexport const GiftPage = ({ extraClass = \"\" }) => {\n  const history = useHistory();\n  const { id } = useParams();\n  const [isPopupOpen, setIsPopupOpen] = useState(false);\n  const [isAddToWishDisabled, setIsAddToWishDisabled] = useState(false);\n  const [currentSupportedBtn, setCurrentSupportedBtn] = useState(100);\n  const [anotherSum, setAnotherSum] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  const [wishData, setWishData] = useState({});\n  useEffect(() => {\n    if (sessionStorage.getItem(\"auth_token\")) {\n      Promise.all([getCard(id), getOwnWishes()]).then(([card, wishlist]) => {\n        setWishData(card);\n        const goodInMyWish = wishlist.find((item) => item.id === card.id);\n        if (goodInMyWish) {\n          setIsAddToWishDisabled(true);\n        }\n      });\n    }\n  }, [id]);\n\n  const isRaised = wishData.raised === wishData.price;\n\n  const handlePopupOpen = () => {\n    setIsPopupOpen(true);\n  };\n\n  const handleSupportClick = () => {\n    errorMessage && setErrorMessage(\"\");\n    const amount = +anotherSum || currentSupportedBtn;\n    addOffer({\n      itemId: wishData.id,\n      amount,\n      hidden: false,\n    })\n      .then(() => {\n        handlePopupClose();\n        getCard(id).then((res) => {\n          setWishData(res);\n        });\n      })\n      .catch((err) => {\n        setErrorMessage(err.message);\n      });\n  };\n\n  const handleGoToShop = () => {\n    window.open(wishData.link, \"_blank\");\n  };\n\n  const handleCopyClick = () => {\n    copyWish(wishData.id).then(() => history.push(\"/wishlist\"));\n  };\n\n  const handlePopupClose = () => {\n    setIsPopupOpen(false);\n  };\n\n  const handleSupportedBtnsClick = (e) => {\n    const id = +e.target.closest(\"button\").getAttribute(\"id\");\n    setCurrentSupportedBtn(id);\n    setAnotherSum(\"\");\n  };\n\n  const handleChangeInput = (e) => {\n    const sum = e.target.value;\n    setAnotherSum(sum);\n    setCurrentSupportedBtn(+sum);\n  };\n\n  return (\n    <section className={`${styles.content} ${extraClass}`}>\n      <ButtonReturn />\n      <h1 className=\"text text_type_h1 mb-16\">{wishData.name}</h1>\n      <div className={styles.data_box}>\n        <img className={styles.img} src={wishData.image} alt=\"Фото подарка.\" />\n        <div className={styles.gift_data}>\n          <h2 className=\"text text_type_h1 mb-16\">{`${wishData.price} руб.`}</h2>\n\n          <p className=\"text text_type_main\" style={{ maxWidth: \"75%\" }}>\n            {`Добавлено ${new Date(\n              wishData.createdAt\n            ).toLocaleDateString()} пользователем `}\n            <NavLink\n              to={`/users/${wishData?.owner?.username}`}\n              className={`text text_type_main text_color_primary ${styles.link}`}\n            >\n              {`${wishData?.owner?.username} ${\"\\u{2197}\"}`}\n            </NavLink>\n          </p>\n          <p\n            className=\"text text_type_main\"\n            style={{ maxWidth: \"75%\" }}\n          >{`Описание: ${wishData.description}`}</p>\n          <LoadingBox\n            current={wishData.raised}\n            total={wishData.price}\n            extraClass={styles.load}\n          />\n          <div className={styles.btns_box}>\n            <Button\n              type=\"support\"\n              kind=\"thirdly\"\n              text=\"Перейти в магазин\"\n              extraClass={styles.btn}\n              onClick={handleGoToShop}\n            />\n            <Button\n              type=\"button\"\n              kind=\"secondary\"\n              text=\"Поддержать\"\n              extraClass={styles.btn}\n              onClick={handlePopupOpen}\n              disabled={isRaised}\n            />\n            <Button\n              type=\"button\"\n              kind=\"support\"\n              text=\"Добавить в вишлист\"\n              extraClass={styles.btn}\n              onClick={handleCopyClick}\n              disabled={isAddToWishDisabled}\n            />\n          </div>\n        </div>\n      </div>\n      <div className={styles.supported_box}>\n        <div className={styles.subtitle_box}>\n          <h2 className=\"text text_ty-e_h2\">Список поддержавших</h2>\n        </div>\n        {wishData?.offers?.length ? (\n          wishData?.offers?.map(({ name, amount, createdAt }) => (\n            <UserSupportedCard name={name} amount={amount} date={createdAt} />\n          ))\n        ) : (\n          <p>Пока никого нет</p>\n        )}\n      </div>\n\n      {isPopupOpen && (\n        <Modal\n          onClose={handlePopupClose}\n          extraClass={styles.modal}\n          isCloseBtn={true}\n        >\n          <div className={styles.popup}>\n            <h2 className=\"text text_type_h2 mb-20\">Поддержите любой суммой</h2>\n            <div className={`mb-20 ${styles.gift_btns_box}`}>\n              {priceArr.map((item, index) => {\n                return (\n                  <Button\n                    key={index}\n                    id={item}\n                    type=\"button\"\n                    extraClass={styles.price_btn}\n                    text={`${item} руб`}\n                    kind={\n                      currentSupportedBtn === item ||\n                      currentSupportedBtn === anotherSum\n                        ? \"primary\"\n                        : \"support\"\n                    }\n                    onClick={handleSupportedBtnsClick}\n                  />\n                );\n              })}\n              <Input\n                type=\"number\"\n                extraInputClass={styles.price_input}\n                placeholder=\"Сумма\"\n                value={anotherSum}\n                onChange={handleChangeInput}\n              />\n            </div>\n            <Button\n              type=\"button\"\n              kind=\"secondary\"\n              text=\"Поддержать\"\n              onClick={handleSupportClick}\n              extraClass={styles.supported_btn}\n            />\n            {errorMessage && (\n              <span className={styles.error}>{errorMessage}</span>\n            )}\n          </div>\n        </Modal>\n      )}\n    </section>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}