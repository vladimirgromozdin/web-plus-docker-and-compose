{"ast":null,"code":"import _defineProperty from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useContext,useRef}from\"react\";import{NavLink,useHistory}from\"react-router-dom\";import{Button}from\"../ui/button/button\";import{Textarea}from\"../ui\";import{Modal}from\"../ui/modal/modal\";import{Input}from\"../ui/input/input\";import logo from\"../../images/icons/logo.svg\";import giftIcon from\"../../images/icons/gift.svg\";import likeIcon from\"../../images/icons/like.svg\";import profileIcon from\"../../images/icons/profile.svg\";import{pluckEmptyFormFields}from\"../../utils/functions\";import{logoutUser,createCard}from\"../../utils/api\";import{UserContext}from\"../../utils/context\";import styles from\"./header.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Header=function Header(_ref){var _ref$extraClass=_ref.extraClass,extraClass=_ref$extraClass===void 0?\"\":_ref$extraClass;var _useContext=useContext(UserContext),_useContext2=_slicedToArray(_useContext,2),userCtx=_useContext2[0],setUserCtx=_useContext2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isProfilePopupOpen=_useState2[0],setIsProfilePopupOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isGiftPopupOpen=_useState4[0],setIsGiftPopupOpen=_useState4[1];var history=useHistory();var isLoggedIn=!!(userCtx!==null&&userCtx!==void 0&&userCtx.id);var onSubmit=function onSubmit(){if(isLoggedIn){handleGiftPopupOpen();}else{history.push(\"/signin\");}};var handleProfilePopupOpen=function handleProfilePopupOpen(){setIsProfilePopupOpen(true);};var handleGiftPopupOpen=function handleGiftPopupOpen(){setIsGiftPopupOpen(true);};var handlePopupClose=function handlePopupClose(){isProfilePopupOpen&&setIsProfilePopupOpen(false);isGiftPopupOpen&&setIsGiftPopupOpen(false);};var logout=function logout(){logoutUser();setUserCtx({});handlePopupClose();history.push({pathname:\"/\"});};return/*#__PURE__*/_jsxs(\"header\",{className:\"\".concat(styles.header,\" \").concat(extraClass),children:[/*#__PURE__*/_jsx(NavLink,{className:styles.nav,to:\"/\",children:/*#__PURE__*/_jsx(\"img\",{className:styles.logo,src:logo,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F.\"})}),isLoggedIn&&/*#__PURE__*/_jsx(HeaderLinks,{handleProfilePopupOpen:handleProfilePopupOpen,userName:userCtx.name}),/*#__PURE__*/_jsx(Button,{type:\"button\",kind:\"primary\",text:\"\".concat(isLoggedIn?\"Добавить подарок\":\"Войти в профиль\"),onClick:onSubmit}),isProfilePopupOpen&&/*#__PURE__*/_jsx(ProfileOptionsPopup,{closePopup:handlePopupClose,logout:logout}),isGiftPopupOpen&&/*#__PURE__*/_jsx(GiftAddModal,{onClose:handlePopupClose})]});};var HeaderLinks=function HeaderLinks(_ref2){var handleProfilePopupOpen=_ref2.handleProfilePopupOpen,userName=_ref2.userName;var profileLabel=userName?\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \".concat(userName):\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\";var setInactive=function setInactive(isActive){var inactiveClassName=\"\".concat(styles.nav,\" \").concat(styles.nav_inactive);return isActive?inactiveClassName:styles.nav;};return/*#__PURE__*/_jsxs(\"ul\",{className:styles.nav_box,children:[/*#__PURE__*/_jsx(\"li\",{className:styles.nav_link,children:/*#__PURE__*/_jsxs(NavLink,{className:setInactive,to:\"/gifts/line\",children:[/*#__PURE__*/_jsx(\"img\",{src:giftIcon,alt:\"\\u0418\\u043A\\u043E\\u043D\\u043A\\u0430 \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u043E\\u0432.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type-main text_color_primary ml-3\",children:\"\\u041F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0438\"})]})}),/*#__PURE__*/_jsx(\"li\",{className:styles.nav_link,children:/*#__PURE__*/_jsxs(NavLink,{className:setInactive,to:\"/wishlist\",children:[/*#__PURE__*/_jsx(\"img\",{src:likeIcon,alt:\"\\u0418\\u043A\\u043E\\u043D\\u043A\\u0430 \\u043B\\u0430\\u0439\\u043A\\u0430.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type-main text_color_primary ml-3\",children:\"\\u041C\\u043E\\u0439 \\u0432\\u0438\\u0448\\u043B\\u0438\\u0441\\u0442\"})]})}),/*#__PURE__*/_jsx(\"li\",{className:styles.nav_link,children:/*#__PURE__*/_jsxs(\"button\",{className:styles.nav,onClick:handleProfilePopupOpen,children:[/*#__PURE__*/_jsx(\"img\",{src:profileIcon,alt:\"\\u0418\\u043A\\u043E\\u043D\\u043A\\u0430 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_main text_color_primary ml-3\",children:profileLabel})]})})]});};var GiftAddModal=function GiftAddModal(_ref3){var onClose=_ref3.onClose;var history=useHistory();var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),giftData=_useState6[0],setGiftData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),valid=_useState8[0],setValid=_useState8[1];var formRef=useRef(null);var submitGift=function submitGift(e){e.preventDefault();var plucked=pluckEmptyFormFields(giftData);createCard(plucked).then(function(){onClose();history.replace({pathname:\"/wishlist\"});});};var onFormChange=function onFormChange(e){e.preventDefault();var isValid=formRef.current.checkValidity();setValid(isValid);setGiftData(_objectSpread(_objectSpread({},giftData),{},_defineProperty({},e.target.name,e.target.name===\"price\"?parseInt(e.target.value):e.target.value)));};return/*#__PURE__*/_jsx(Modal,{onClose:onClose,extraClass:styles.gift_modal,isCloseBtn:true,children:/*#__PURE__*/_jsxs(\"form\",{className:styles.gift_form,onSubmit:submitGift,ref:formRef,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text text_type_h2 mb-16\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u0434\\u0430\\u0440\\u043E\\u043A\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",id:20,extraClass:\"mb-12\",label:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0430\",name:\"name\",onChange:onFormChange,placeholder:\"\\u0423\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0430\",required:true}),/*#__PURE__*/_jsx(Input,{type:\"url\",extraClass:\"mb-12\",name:\"link\",label:\"\\u0421\\u0441\\u044B\\u043B\\u043A\\u0430 \\u043D\\u0430 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\",onChange:onFormChange,placeholder:\"\\u0423\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u0441\\u0441\\u044B\\u043B\\u043A\\u0443\",required:true}),/*#__PURE__*/_jsx(Input,{type:\"url\",extraClass:\"mb-12\",name:\"image\",label:\"\\u0421\\u0441\\u044B\\u043B\\u043A\\u0430 \\u043D\\u0430 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435 \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0430\",onChange:onFormChange,placeholder:\"\\u0423\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u0441\\u0441\\u044B\\u043B\\u043A\\u0443\",required:true}),/*#__PURE__*/_jsx(Textarea,{name:\"description\",id:23,placeholder:\"\\u041D\\u0435\\u0441\\u043A\\u043E\\u043B\\u044C\\u043A\\u043E \\u0441\\u043B\\u043E\\u0432 \\u043E \\u0432\\u0430\\u0448\\u0435\\u043C \\u0436\\u0435\\u043B\\u0430\\u043D\\u0438\\u0438\",label:\"\\u0420\\u0430\\u0441\\u0441\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u043E \\u0432\\u0430\\u0448\\u0435\\u043C \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0435\",onChange:onFormChange,maxLength:1024,required:true}),/*#__PURE__*/_jsx(Input,{type:\"number\",name:\"price\",id:24,extraClass:\"mb-16 \".concat(styles.price_input),label:\"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C \\u043F\\u043E\\u0434\\u0430\\u0440\\u043A\\u0430 (\\u0440\\u0443\\u0431.)\",onChange:onFormChange,placeholder:\"\\u0423\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C\",required:true,min:0}),/*#__PURE__*/_jsx(Button,{type:\"submit\",extraClass:styles.gift_btn,text:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u0434\\u0430\\u0440\\u043E\\u043A\",kind:\"secondary\",disabled:!valid})]})});};var ProfileOptionsPopup=function ProfileOptionsPopup(_ref4){var closePopup=_ref4.closePopup,logout=_ref4.logout;return/*#__PURE__*/_jsx(Modal,{onClose:closePopup,extraClass:styles.modal,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.popup,children:[/*#__PURE__*/_jsx(\"button\",{className:\"text text_type_button text_color_primary \".concat(styles.popup_btn,\" \").concat(styles.logout),type:\"button\",onClick:logout,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438 \\u0438\\u0437 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.line}),/*#__PURE__*/_jsx(NavLink,{to:\"/profile\",className:\"text text_type_button text_color_primary \".concat(styles.popup_btn,\" \").concat(styles.edit),onClick:closePopup,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"})]})});};","map":{"version":3,"sources":["/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/src/components/header/header.jsx"],"names":["useState","useContext","useRef","NavLink","useHistory","Button","Textarea","Modal","Input","logo","giftIcon","likeIcon","profileIcon","pluckEmptyFormFields","logoutUser","createCard","UserContext","styles","Header","extraClass","userCtx","setUserCtx","isProfilePopupOpen","setIsProfilePopupOpen","isGiftPopupOpen","setIsGiftPopupOpen","history","isLoggedIn","id","onSubmit","handleGiftPopupOpen","push","handleProfilePopupOpen","handlePopupClose","logout","pathname","header","nav","name","HeaderLinks","userName","profileLabel","setInactive","isActive","inactiveClassName","nav_inactive","nav_box","nav_link","GiftAddModal","onClose","giftData","setGiftData","valid","setValid","formRef","submitGift","e","preventDefault","plucked","then","replace","onFormChange","isValid","current","checkValidity","target","parseInt","value","gift_modal","gift_form","price_input","gift_btn","ProfileOptionsPopup","closePopup","modal","popup","popup_btn","line","edit"],"mappings":"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","sourcesContent":["import { useState, useContext, useRef } from \"react\";\nimport { NavLink, useHistory } from \"react-router-dom\";\n\nimport { Button } from \"../ui/button/button\";\nimport { Textarea } from \"../ui\";\nimport { Modal } from \"../ui/modal/modal\";\nimport { Input } from \"../ui/input/input\";\n\nimport logo from \"../../images/icons/logo.svg\";\nimport giftIcon from \"../../images/icons/gift.svg\";\nimport likeIcon from \"../../images/icons/like.svg\";\nimport profileIcon from \"../../images/icons/profile.svg\";\n\nimport { pluckEmptyFormFields } from \"../../utils/functions\";\nimport { logoutUser, createCard } from \"../../utils/api\";\nimport { UserContext } from \"../../utils/context\";\n\nimport styles from \"./header.module.css\";\n\nexport const Header = ({ extraClass = \"\" }) => {\n  const [userCtx, setUserCtx] = useContext(UserContext);\n  const [isProfilePopupOpen, setIsProfilePopupOpen] = useState(false);\n  const [isGiftPopupOpen, setIsGiftPopupOpen] = useState(false);\n\n  const history = useHistory();\n  const isLoggedIn = !!userCtx?.id;\n\n  const onSubmit = () => {\n    if (isLoggedIn) {\n      handleGiftPopupOpen();\n    } else {\n      history.push(\"/signin\");\n    }\n  };\n\n  const handleProfilePopupOpen = () => {\n    setIsProfilePopupOpen(true);\n  };\n\n  const handleGiftPopupOpen = () => {\n    setIsGiftPopupOpen(true);\n  };\n\n  const handlePopupClose = () => {\n    isProfilePopupOpen && setIsProfilePopupOpen(false);\n    isGiftPopupOpen && setIsGiftPopupOpen(false);\n  };\n\n  const logout = () => {\n    logoutUser();\n    setUserCtx({});\n    handlePopupClose();\n    history.push({ pathname: \"/\" });\n  };\n\n  return (\n    <header className={`${styles.header} ${extraClass}`}>\n      <NavLink className={styles.nav} to=\"/\">\n        <img className={styles.logo} src={logo} alt=\"Логотип.\" />\n      </NavLink>\n      {isLoggedIn && (\n        <HeaderLinks\n          handleProfilePopupOpen={handleProfilePopupOpen}\n          userName={userCtx.name}\n        />\n      )}\n      <Button\n        type=\"button\"\n        kind=\"primary\"\n        text={`${isLoggedIn ? \"Добавить подарок\" : \"Войти в профиль\"}`}\n        onClick={onSubmit}\n      />\n      {isProfilePopupOpen && (\n        <ProfileOptionsPopup closePopup={handlePopupClose} logout={logout} />\n      )}\n      {isGiftPopupOpen && <GiftAddModal onClose={handlePopupClose} />}\n    </header>\n  );\n};\n\nconst HeaderLinks = ({ handleProfilePopupOpen, userName }) => {\n  const profileLabel = userName ? `Профиль ${userName}` : `Профиль`;\n\n  const setInactive = (isActive) => {\n    const inactiveClassName = `${styles.nav} ${styles.nav_inactive}`;\n\n    return isActive ? inactiveClassName : styles.nav;\n  };\n\n  return (\n    <ul className={styles.nav_box}>\n      <li className={styles.nav_link}>\n        <NavLink className={setInactive} to=\"/gifts/line\">\n          <img src={giftIcon} alt=\"Иконка подарков.\" />\n          <p className=\"text text_type-main text_color_primary ml-3\">Подарки</p>\n        </NavLink>\n      </li>\n      <li className={styles.nav_link}>\n        <NavLink className={setInactive} to=\"/wishlist\">\n          <img src={likeIcon} alt=\"Иконка лайка.\" />\n          <p className=\"text text_type-main text_color_primary ml-3\">\n            Мой вишлист\n          </p>\n        </NavLink>\n      </li>\n      <li className={styles.nav_link}>\n        <button className={styles.nav} onClick={handleProfilePopupOpen}>\n          <img src={profileIcon} alt=\"Иконка профиля.\" />\n          <p className=\"text text_type_main text_color_primary ml-3\">\n            {profileLabel}\n          </p>\n        </button>\n      </li>\n    </ul>\n  );\n};\n\nconst GiftAddModal = ({ onClose }) => {\n  const history = useHistory();\n  const [giftData, setGiftData] = useState({});\n  const [valid, setValid] = useState(false);\n\n  const formRef = useRef(null);\n\n  const submitGift = (e) => {\n    e.preventDefault();\n    const plucked = pluckEmptyFormFields(giftData);\n    createCard(plucked).then(() => {\n      onClose();\n      history.replace({ pathname: \"/wishlist\" });\n    });\n  };\n\n  const onFormChange = (e) => {\n    e.preventDefault();\n    const isValid = formRef.current.checkValidity();\n    setValid(isValid);\n    setGiftData({\n      ...giftData,\n      [e.target.name]:\n        e.target.name === \"price\" ? parseInt(e.target.value) : e.target.value,\n    });\n  };\n\n  return (\n    <Modal onClose={onClose} extraClass={styles.gift_modal} isCloseBtn={true}>\n      <form className={styles.gift_form} onSubmit={submitGift} ref={formRef}>\n        <h2 className=\"text text_type_h2 mb-16\">Добавить подарок</h2>\n        <Input\n          type=\"text\"\n          id={20}\n          extraClass=\"mb-12\"\n          label=\"Название подарка\"\n          name=\"name\"\n          onChange={onFormChange}\n          placeholder=\"Укажите название подарка\"\n          required\n        />\n        <Input\n          type=\"url\"\n          extraClass=\"mb-12\"\n          name=\"link\"\n          label=\"Ссылка на магазин\"\n          onChange={onFormChange}\n          placeholder=\"Укажите ссылку\"\n          required\n        />\n        <Input\n          type=\"url\"\n          extraClass=\"mb-12\"\n          name=\"image\"\n          label=\"Ссылка на изображение подарка\"\n          onChange={onFormChange}\n          placeholder=\"Укажите ссылку\"\n          required\n        />\n        <Textarea\n          name=\"description\"\n          id={23}\n          placeholder=\"Несколько слов о вашем желании\"\n          label=\"Расскажите о вашем подарке\"\n          onChange={onFormChange}\n          maxLength={1024}\n          required\n        />\n        <Input\n          type=\"number\"\n          name=\"price\"\n          id={24}\n          extraClass={`mb-16 ${styles.price_input}`}\n          label=\"Стоимость подарка (руб.)\"\n          onChange={onFormChange}\n          placeholder=\"Укажите стоимость\"\n          required\n          min={0}\n        />\n        <Button\n          type=\"submit\"\n          extraClass={styles.gift_btn}\n          text=\"Добавить подарок\"\n          kind=\"secondary\"\n          disabled={!valid}\n        />\n      </form>\n    </Modal>\n  );\n};\n\nconst ProfileOptionsPopup = ({ closePopup, logout }) => {\n  return (\n    <Modal onClose={closePopup} extraClass={styles.modal}>\n      <div className={styles.popup}>\n        <button\n          className={`text text_type_button text_color_primary ${styles.popup_btn} ${styles.logout}`}\n          type=\"button\"\n          onClick={logout}\n        >\n          Выйти из профиля\n        </button>\n        <div className={styles.line} />\n        <NavLink\n          to=\"/profile\"\n          className={`text text_type_button text_color_primary ${styles.popup_btn} ${styles.edit}`}\n          onClick={closePopup}\n        >\n          Редактировать профиль\n        </NavLink>\n      </div>\n    </Modal>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}