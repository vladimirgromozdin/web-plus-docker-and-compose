{"ast":null,"code":"import _objectWithoutProperties from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _asyncToGenerator from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _excluded=[\"avatar\"];import _regeneratorRuntime from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{useContext,useEffect,useState}from\"react\";import{NavLink,useHistory}from\"react-router-dom\";import{Input,Button,Textarea}from\"../ui\";import{UserContext}from\"../../utils/context\";import{getOwnUser,loginUser,registerUser}from\"../../utils/api\";import{MINIMUM_PASSWORD_LENGTH,MINIMUM_USERNAME_LENGTH,MAXIMUM_DESCRIPTION_LENGTH,EMAIL_REGULAR,URL_REGULAR,MAXIMUM_USERNAME_LENGTH}from\"../../utils/constants\";import styles from\"./sign-up.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var SignUp=function SignUp(_ref){var _ref$extraClass=_ref.extraClass,extraClass=_ref$extraClass===void 0?\"\":_ref$extraClass;var _useContext=useContext(UserContext),_useContext2=_slicedToArray(_useContext,2),_user=_useContext2[0],setUser=_useContext2[1];var _useState=useState({username:\"\",email:\"\",password:\"\",about:\"\",avatar:\"\"}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),step=_useState4[0],setStep=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),stepOneDisabled=_useState8[0],setStepOneDisabled=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),stepTwoDisabled=_useState10[0],setStepTwoDisabled=_useState10[1];var history=useHistory();useEffect(function(){errorMessage&&setErrorMessage(\"\");var usernameValid=userData.username.length>=MINIMUM_USERNAME_LENGTH&&userData.username.length<=MAXIMUM_USERNAME_LENGTH;var passwordValid=userData.password.length>=MINIMUM_PASSWORD_LENGTH;var emailValid=EMAIL_REGULAR.test(userData.email);var descriptionValid=userData.about.length<MAXIMUM_DESCRIPTION_LENGTH;var avatarValid=userData.avatar?URL_REGULAR.test(userData.avatar):true;setStepOneDisabled(!usernameValid||!passwordValid||!emailValid);setStepTwoDisabled(!descriptionValid||!avatarValid);},[step,userData]);var onChangeInput=function onChangeInput(e){var name=e.target.name;var value=e.target.value;setUserData(_objectSpread(_objectSpread({},userData),{},_defineProperty({},name,value)));};var handleBackToFirstStep=function handleBackToFirstStep(){return setStep(1);};var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var avatar,rest,_yield$loginUser,access_token,userDto;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(step===1)){_context.next=4;break;}setStep(2);_context.next=36;break;case 4:avatar=userData.avatar,rest=_objectWithoutProperties(userData,_excluded);errorMessage&&setErrorMessage(\"\");_context.prev=6;if(!avatar){_context.next=12;break;}_context.next=10;return registerUser(userData);case 10:_context.next=14;break;case 12:_context.next=14;return registerUser(rest);case 14:_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](6);setErrorMessage(_context.t0.message);return _context.abrupt(\"return\");case 20:_context.prev=20;_context.next=23;return loginUser(userData.username,userData.password);case 23:_yield$loginUser=_context.sent;access_token=_yield$loginUser.access_token;if(!access_token){_context.next=31;break;}_context.next=28;return getOwnUser();case 28:userDto=_context.sent;console.log(userDto);if(userDto.id){setUser(_objectSpread({},userDto));history.replace({pathname:\"/\"});}case 31:_context.next=36;break;case 33:_context.prev=33;_context.t1=_context[\"catch\"](20);history.replace({pathname:\"/signin\"});case 36:case\"end\":return _context.stop();}}},_callee,null,[[6,16],[20,33]]);}));return function handleSubmit(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.content,\" \").concat(extraClass),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text text_type_h2 text_color_primary mb-16 \".concat(styles.title),children:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F \".concat(step===1?\"1/2\":\"2/2\")}),/*#__PURE__*/_jsxs(\"form\",{className:styles.form,children:[step===1?/*#__PURE__*/_jsx(StepOne,{onChangeInput:onChangeInput,data:userData}):/*#__PURE__*/_jsx(StepTwo,{onChangeInput:onChangeInput}),errorMessage&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:styles.error,children:errorMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:styles.back_to_first_step,onClick:handleBackToFirstStep,children:\"\\u0412\\u0435\\u0440\\u043D\\u0443\\u0442\\u044C\\u0441\\u044F \\u043D\\u0430 \\u043F\\u0435\\u0440\\u0432\\u044B\\u0439 \\u0448\\u0430\\u0433\"})]}),/*#__PURE__*/_jsx(Button,{type:\"button\",kind:\"secondary\",text:\"\".concat(step===1?\"Далее\":\"Зарегистрироваться\"),disabled:step===1?stepOneDisabled:stepTwoDisabled,extraClass:styles.btn,onClick:handleSubmit})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.links_box,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_main text_color_primary mb-9 \".concat(styles.text),children:\"\\u0423\\u0436\\u0435 \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u044B?\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/signin\",className:\"text text_type_button text_color_primary \".concat(styles.nav),children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})]});};var StepOne=function StepOne(_ref3){var onChangeInput=_ref3.onChangeInput,data=_ref3.data;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Input,{name:\"username\",type:\"username\",id:1,placeholder:\"\\u041F\\u0440\\u0438\\u0434\\u0443\\u043C\\u0430\\u0439\\u0442\\u0435 \\u044E\\u0437\\u0435\\u0440\\u043D\\u0435\\u0439\\u043C\",label:\"\\u042E\\u0437\\u0435\\u0440\\u043D\\u0435\\u0439\\u043C\",value:data.username,onChange:onChangeInput,extraClass:\"mb-16\",required:true,maxLength:MAXIMUM_USERNAME_LENGTH}),/*#__PURE__*/_jsx(Input,{name:\"email\",type:\"email\",id:2,placeholder:\"\\u0423\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u0442\\u0443\\u0442\",label:\"E-mail\",value:data.email,onChange:onChangeInput,extraClass:\"mb-16\",required:true}),/*#__PURE__*/_jsx(Input,{name:\"password\",type:\"password\",id:3,placeholder:\"\\u041F\\u0440\\u0438\\u0434\\u0443\\u043C\\u0430\\u0439\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",label:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",value:data.password,onChange:onChangeInput,minLength:MINIMUM_PASSWORD_LENGTH,required:true})]});};var StepTwo=function StepTwo(_ref4){var onChangeInput=_ref4.onChangeInput;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Textarea,{name:\"about\",type:\"about\",id:5,placeholder:\"\\u0420\\u0430\\u0441\\u0441\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u043E \\u0441\\u0435\\u0431\\u0435\",label:\"\\u041E \\u0441\\u0435\\u0431\\u0435\",onChange:onChangeInput,extraClass:\"mb-16\",maxLength:MAXIMUM_DESCRIPTION_LENGTH}),/*#__PURE__*/_jsx(Input,{name:\"avatar\",type:\"url\",id:7,placeholder:\"\\u0423\\u043A\\u0430\\u0436\\u0438\\u0442\\u0435 \\u0442\\u0443\\u0442 \\u0441\\u0441\\u044B\\u043B\\u043A\\u0443 \\u043D\\u0430 \\u0430\\u0432\\u0430\\u0442\\u0430\\u0440\",label:\"\\u0410\\u0432\\u0430\\u0442\\u0430\\u0440\",onChange:onChangeInput,extraClass:\"mb-16\"})]});};","map":{"version":3,"sources":["/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/src/components/sign-up/sign-up.jsx"],"names":["useContext","useEffect","useState","NavLink","useHistory","Input","Button","Textarea","UserContext","getOwnUser","loginUser","registerUser","MINIMUM_PASSWORD_LENGTH","MINIMUM_USERNAME_LENGTH","MAXIMUM_DESCRIPTION_LENGTH","EMAIL_REGULAR","URL_REGULAR","MAXIMUM_USERNAME_LENGTH","styles","SignUp","extraClass","_user","setUser","username","email","password","about","avatar","userData","setUserData","step","setStep","errorMessage","setErrorMessage","stepOneDisabled","setStepOneDisabled","stepTwoDisabled","setStepTwoDisabled","history","usernameValid","length","passwordValid","emailValid","test","descriptionValid","avatarValid","onChangeInput","e","name","target","value","handleBackToFirstStep","handleSubmit","rest","message","access_token","userDto","console","log","id","replace","pathname","content","title","form","error","back_to_first_step","btn","links_box","text","nav","StepOne","data","StepTwo"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport { NavLink, useHistory } from \"react-router-dom\";\n\nimport { Input, Button, Textarea } from \"../ui\";\n\nimport { UserContext } from \"../../utils/context\";\nimport { getOwnUser, loginUser, registerUser } from \"../../utils/api\";\n\nimport {\n  MINIMUM_PASSWORD_LENGTH,\n  MINIMUM_USERNAME_LENGTH,\n  MAXIMUM_DESCRIPTION_LENGTH,\n  EMAIL_REGULAR,\n  URL_REGULAR,\n  MAXIMUM_USERNAME_LENGTH,\n} from \"../../utils/constants\";\n\nimport styles from \"./sign-up.module.css\";\n\nexport const SignUp = ({ extraClass = \"\" }) => {\n  const [_user, setUser] = useContext(UserContext);\n  const [userData, setUserData] = useState({\n    username: \"\",\n    email: \"\",\n    password: \"\",\n    about: \"\",\n    avatar: \"\",\n  });\n  const [step, setStep] = useState(1);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [stepOneDisabled, setStepOneDisabled] = useState(true);\n  const [stepTwoDisabled, setStepTwoDisabled] = useState(true);\n  const history = useHistory();\n\n  useEffect(() => {\n    errorMessage && setErrorMessage(\"\");\n    const usernameValid =\n      userData.username.length >= MINIMUM_USERNAME_LENGTH &&\n      userData.username.length <= MAXIMUM_USERNAME_LENGTH;\n    const passwordValid = userData.password.length >= MINIMUM_PASSWORD_LENGTH;\n    const emailValid = EMAIL_REGULAR.test(userData.email);\n    const descriptionValid = userData.about.length < MAXIMUM_DESCRIPTION_LENGTH;\n    const avatarValid = userData.avatar\n      ? URL_REGULAR.test(userData.avatar)\n      : true;\n\n    setStepOneDisabled(!usernameValid || !passwordValid || !emailValid);\n    setStepTwoDisabled(!descriptionValid || !avatarValid);\n  }, [step, userData]);\n\n  const onChangeInput = (e) => {\n    const name = e.target.name;\n    const value = e.target.value;\n    setUserData({\n      ...userData,\n      [name]: value,\n    });\n  };\n\n  const handleBackToFirstStep = () => setStep(1);\n\n  const handleSubmit = async () => {\n    if (step === 1) {\n      setStep(2);\n    } else {\n      const { avatar, ...rest } = userData;\n      errorMessage && setErrorMessage(\"\");\n      try {\n        if (avatar) {\n          await registerUser(userData);\n        } else {\n          await registerUser(rest);\n        }\n      } catch (err) {\n        setErrorMessage(err.message);\n        return;\n      }\n\n      try {\n        const { access_token } = await loginUser(\n          userData.username,\n          userData.password\n        );\n        if (access_token) {\n          const userDto = await getOwnUser();\n          console.log(userDto);\n\n          if (userDto.id) {\n            setUser({ ...userDto });\n            history.replace({ pathname: \"/\" });\n          }\n        }\n      } catch (_err) {\n        history.replace({ pathname: \"/signin\" });\n      }\n    }\n  };\n\n  return (\n    <div className={`${styles.content} ${extraClass}`}>\n      <h2\n        className={`text text_type_h2 text_color_primary mb-16 ${styles.title}`}\n      >\n        {`Регистрация ${step === 1 ? \"1/2\" : \"2/2\"}`}\n      </h2>\n      <form className={styles.form}>\n        {step === 1 ? (\n          <StepOne onChangeInput={onChangeInput} data={userData} />\n        ) : (\n          <StepTwo onChangeInput={onChangeInput} />\n        )}\n        {errorMessage && (\n          <>\n            <span className={styles.error}>{errorMessage}</span>\n            <button\n              type=\"button\"\n              className={styles.back_to_first_step}\n              onClick={handleBackToFirstStep}\n            >\n              Вернуться на первый шаг\n            </button>\n          </>\n        )}\n        <Button\n          type=\"button\"\n          kind=\"secondary\"\n          text={`${step === 1 ? \"Далее\" : \"Зарегистрироваться\"}`}\n          disabled={step === 1 ? stepOneDisabled : stepTwoDisabled}\n          extraClass={styles.btn}\n          onClick={handleSubmit}\n        />\n      </form>\n      <div className={styles.links_box}>\n        <p\n          className={`text text_type_main text_color_primary mb-9 ${styles.text}`}\n        >\n          Уже зарегистрированы?\n        </p>\n        <NavLink\n          to=\"/signin\"\n          className={`text text_type_button text_color_primary ${styles.nav}`}\n        >\n          Войти\n        </NavLink>\n      </div>\n    </div>\n  );\n};\n\nconst StepOne = ({ onChangeInput, data }) => {\n  return (\n    <>\n      <Input\n        name=\"username\"\n        type=\"username\"\n        id={1}\n        placeholder=\"Придумайте юзернейм\"\n        label=\"Юзернейм\"\n        value={data.username}\n        onChange={onChangeInput}\n        extraClass=\"mb-16\"\n        required={true}\n        maxLength={MAXIMUM_USERNAME_LENGTH}\n      />\n      <Input\n        name=\"email\"\n        type=\"email\"\n        id={2}\n        placeholder=\"Укажите тут\"\n        label=\"E-mail\"\n        value={data.email}\n        onChange={onChangeInput}\n        extraClass=\"mb-16\"\n        required={true}\n      />\n      <Input\n        name=\"password\"\n        type=\"password\"\n        id={3}\n        placeholder=\"Придумайте пароль\"\n        label=\"Пароль\"\n        value={data.password}\n        onChange={onChangeInput}\n        minLength={MINIMUM_PASSWORD_LENGTH}\n        required={true}\n      />\n    </>\n  );\n};\n\nconst StepTwo = ({ onChangeInput }) => {\n  return (\n    <>\n      <Textarea\n        name=\"about\"\n        type=\"about\"\n        id={5}\n        placeholder=\"Расскажите о себе\"\n        label=\"О себе\"\n        onChange={onChangeInput}\n        extraClass=\"mb-16\"\n        maxLength={MAXIMUM_DESCRIPTION_LENGTH}\n      />\n      <Input\n        name=\"avatar\"\n        type=\"url\"\n        id={7}\n        placeholder=\"Укажите тут ссылку на аватар\"\n        label=\"Аватар\"\n        onChange={onChangeInput}\n        extraClass=\"mb-16\"\n      />\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}