{"ast":null,"code":"import _asyncToGenerator from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{useState,useContext}from\"react\";import{NavLink,useHistory}from\"react-router-dom\";import{Input,Button}from\"../ui\";import{getOwnUser,loginUser}from\"../../utils/api\";import{UserContext}from\"../../utils/context\";import{MINIMUM_USERNAME_LENGTH,MINIMUM_PASSWORD_LENGTH}from\"../../utils/constants\";import styles from\"./sign-in.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var SignIn=function SignIn(_ref){var _ref$extraClass=_ref.extraClass,extraClass=_ref$extraClass===void 0?\"\":_ref$extraClass;var _useContext=useContext(UserContext),_useContext2=_slicedToArray(_useContext,2),_userCtx=_useContext2[0],setUserCtx=_useContext2[1];var _useState=useState({username:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var history=useHistory();var usernameValid=userData.username.length>=MINIMUM_USERNAME_LENGTH;var passwordValid=userData.password.length>=MINIMUM_PASSWORD_LENGTH;var submitDisabled=!usernameValid||!passwordValid;var onChangeInput=function onChangeInput(e){setUserData(_objectSpread(_objectSpread({},userData),{},_defineProperty({},e.target.name,e.target.value)));};var authorizeUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var response,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();errorMessage&&setErrorMessage(\"\");_context.prev=2;_context.next=5;return loginUser(userData.username,userData.password);case 5:response=_context.sent;if(!(response&&response.access_token)){_context.next=12;break;}_context.next=9;return getOwnUser();case 9:user=_context.sent;setUserCtx(user);history.replace({pathname:\"/gifts/line\"});case 12:_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);setErrorMessage(_context.t0.message);case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return function authorizeUser(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.content,\" \").concat(extraClass),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text text_type_h2 text_color_primary mb-16 \".concat(styles.title),children:\"\\u0412\\u0445\\u043E\\u0434\"}),/*#__PURE__*/_jsxs(\"form\",{className:styles.form,onSubmit:authorizeUser,children:[/*#__PURE__*/_jsx(Input,{name:\"username\",type:\"text\",id:1,placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0438\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",label:\"\\u042E\\u0437\\u0435\\u0440\\u043D\\u0435\\u0439\\u043C\",onChange:onChangeInput,extraClass:\"mb-16\",minLength:MINIMUM_USERNAME_LENGTH,required:true}),/*#__PURE__*/_jsx(Input,{name:\"password\",type:\"password\",id:2,placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",label:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",onChange:onChangeInput,minLength:MINIMUM_PASSWORD_LENGTH,required:true}),errorMessage&&/*#__PURE__*/_jsx(\"span\",{className:styles.error,children:errorMessage}),/*#__PURE__*/_jsx(Button,{type:\"submit\",kind:\"secondary\",text:\"\\u0412\\u043E\\u0439\\u0442\\u0438\",extraClass:styles.btn,disabled:submitDisabled})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.links_box,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text text_type_main text_color_primary mb-9 \".concat(styles.text),children:\"\\u0412\\u044B \\u2014 \\u043D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C?\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/signup\",className:\"text text_type_button text_color_primary \".concat(styles.nav),children:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]})]});};","map":{"version":3,"sources":["/Users/vladimirgromozdin/Documents/dev/deploy-kupipodariday/frontend/src/components/sign-in/sign-in.jsx"],"names":["useState","useContext","NavLink","useHistory","Input","Button","getOwnUser","loginUser","UserContext","MINIMUM_USERNAME_LENGTH","MINIMUM_PASSWORD_LENGTH","styles","SignIn","extraClass","_userCtx","setUserCtx","username","password","userData","setUserData","errorMessage","setErrorMessage","history","usernameValid","length","passwordValid","submitDisabled","onChangeInput","e","target","name","value","authorizeUser","event","preventDefault","response","access_token","user","replace","pathname","message","content","title","form","error","btn","links_box","text","nav"],"mappings":"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","sourcesContent":["import { useState, useContext } from \"react\";\nimport { NavLink, useHistory } from \"react-router-dom\";\n\nimport { Input, Button } from \"../ui\";\n\nimport { getOwnUser, loginUser } from \"../../utils/api\";\n\nimport { UserContext } from \"../../utils/context\";\n\nimport {\n  MINIMUM_USERNAME_LENGTH,\n  MINIMUM_PASSWORD_LENGTH,\n} from \"../../utils/constants\";\n\nimport styles from \"./sign-in.module.css\";\n\nexport const SignIn = ({ extraClass = \"\" }) => {\n  const [_userCtx, setUserCtx] = useContext(UserContext);\n  const [userData, setUserData] = useState({\n    username: \"\",\n    password: \"\",\n  });\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  const history = useHistory();\n\n  const usernameValid = userData.username.length >= MINIMUM_USERNAME_LENGTH;\n  const passwordValid = userData.password.length >= MINIMUM_PASSWORD_LENGTH;\n  const submitDisabled = !usernameValid || !passwordValid;\n\n  const onChangeInput = (e) => {\n    setUserData({\n      ...userData,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  const authorizeUser = async (event) => {\n    event.preventDefault();\n    errorMessage && setErrorMessage(\"\");\n    try {\n      const response = await loginUser(userData.username, userData.password);\n      if (response && response.access_token) {\n        const user = await getOwnUser();\n        setUserCtx(user);\n        history.replace({ pathname: \"/gifts/line\" });\n      }\n    } catch (err) {\n      setErrorMessage(err.message);\n    }\n  };\n\n  return (\n    <div className={`${styles.content} ${extraClass}`}>\n      <h2\n        className={`text text_type_h2 text_color_primary mb-16 ${styles.title}`}\n      >\n        Вход\n      </h2>\n      <form className={styles.form} onSubmit={authorizeUser}>\n        <Input\n          name={\"username\"}\n          type=\"text\"\n          id={1}\n          placeholder=\"Введите имя пользователя\"\n          label=\"Юзернейм\"\n          onChange={onChangeInput}\n          extraClass=\"mb-16\"\n          minLength={MINIMUM_USERNAME_LENGTH}\n          required={true}\n        />\n        <Input\n          name={\"password\"}\n          type=\"password\"\n          id={2}\n          placeholder=\"Введите пароль\"\n          label=\"Пароль\"\n          onChange={onChangeInput}\n          minLength={MINIMUM_PASSWORD_LENGTH}\n          required={true}\n        />\n        {errorMessage && <span className={styles.error}>{errorMessage}</span>}\n        <Button\n          type=\"submit\"\n          kind=\"secondary\"\n          text=\"Войти\"\n          extraClass={styles.btn}\n          disabled={submitDisabled}\n        />\n      </form>\n      <div className={styles.links_box}>\n        <p\n          className={`text text_type_main text_color_primary mb-9 ${styles.text}`}\n        >\n          Вы — новый пользователь?\n        </p>\n        <NavLink\n          to=\"/signup\"\n          className={`text text_type_button text_color_primary ${styles.nav}`}\n        >\n          Зарегистрироваться\n        </NavLink>\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}